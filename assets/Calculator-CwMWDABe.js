import{r as C,G as Re,j as c}from"./index-CV_2wjtk.js";var O="INUMBER",G="IOP1",$="IOP2",X="IOP3",j="IVAR",L="IVARNAME",B="IFUNCALL",Q="IFUNDEF",M="IEXPR",he="IEXPREVAL",V="IMEMBER",z="IENDSTATEMENT",_="IARRAY";function v(e,t){this.type=e,this.value=t??0}v.prototype.toString=function(){switch(this.type){case O:case G:case $:case X:case j:case L:case z:return this.value;case B:return"CALL "+this.value;case Q:return"DEF "+this.value;case _:return"ARRAY "+this.value;case V:return"."+this.value;default:return"Invalid Instruction"}};function Z(e){return new v(G,e)}function P(e){return new v($,e)}function Oe(e){return new v(X,e)}function ue(e,t,r,s,n){for(var a=[],i=[],h,l,w,p,y=0;y<e.length;y++){var u=e[y],f=u.type;if(f===O||f===L)Array.isArray(u.value)?a.push.apply(a,ue(u.value.map(function(R){return new v(O,R)}).concat(new v(_,u.value.length)),t,r,s,n)):a.push(u);else if(f===j&&n.hasOwnProperty(u.value))u=new v(O,n[u.value]),a.push(u);else if(f===$&&a.length>1)l=a.pop(),h=a.pop(),p=r[u.value],u=new v(O,p(h.value,l.value)),a.push(u);else if(f===X&&a.length>2)w=a.pop(),l=a.pop(),h=a.pop(),u.value==="?"?a.push(h.value?l.value:w.value):(p=s[u.value],u=new v(O,p(h.value,l.value,w.value)),a.push(u));else if(f===G&&a.length>0)h=a.pop(),p=t[u.value],u=new v(O,p(h.value)),a.push(u);else if(f===M){for(;a.length>0;)i.push(a.shift());i.push(new v(M,ue(u.value,t,r,s,n)))}else if(f===V&&a.length>0)h=a.pop(),a.push(new v(O,h.value[u.value]));else{for(;a.length>0;)i.push(a.shift());i.push(u)}}for(;a.length>0;)i.push(a.shift());return i}function Te(e,t,r){for(var s=[],n=0;n<e.length;n++){var a=e[n],i=a.type;if(i===j&&a.value===t)for(var h=0;h<r.tokens.length;h++){var l=r.tokens[h],w;l.type===G?w=Z(l.value):l.type===$?w=P(l.value):l.type===X?w=Oe(l.value):w=new v(l.type,l.value),s.push(w)}else i===M?s.push(new v(M,Te(a.value,t,r))):s.push(a)}return s}function q(e,t,r){var s=[],n,a,i,h,l,w;if(pe(e))return I(e,r);for(var p=e.length,y=0;y<p;y++){var u=e[y],f=u.type;if(f===O||f===L)s.push(u.value);else if(f===$)a=s.pop(),n=s.pop(),u.value==="and"?s.push(n?!!q(a,t,r):!1):u.value==="or"?s.push(n?!0:!!q(a,t,r)):u.value==="="?(h=t.binaryOps[u.value],s.push(h(n,q(a,t,r),r))):(h=t.binaryOps[u.value],s.push(h(I(n,r),I(a,r))));else if(f===X)i=s.pop(),a=s.pop(),n=s.pop(),u.value==="?"?s.push(q(n?a:i,t,r)):(h=t.ternaryOps[u.value],s.push(h(I(n,r),I(a,r),I(i,r))));else if(f===j)if(u.value in t.functions)s.push(t.functions[u.value]);else if(u.value in t.unaryOps&&t.parser.isOperatorEnabled(u.value))s.push(t.unaryOps[u.value]);else{var R=r[u.value];if(R!==void 0)s.push(R);else throw new Error("undefined variable: "+u.value)}else if(f===G)n=s.pop(),h=t.unaryOps[u.value],s.push(h(I(n,r)));else if(f===B){for(w=u.value,l=[];w-- >0;)l.unshift(I(s.pop(),r));if(h=s.pop(),h.apply&&h.call)s.push(h.apply(void 0,l));else throw new Error(h+" is not a function")}else if(f===Q)s.push(function(){for(var te=s.pop(),F=[],re=u.value;re-- >0;)F.unshift(s.pop());var d=s.pop(),D=function(){for(var K=Object.assign({},r),S=0,Y=F.length;S<Y;S++)K[F[S]]=arguments[S];return q(te,t,K)};return Object.defineProperty(D,"name",{value:d,writable:!1}),r[d]=D,D}());else if(f===M)s.push(Fe(u,t));else if(f===he)s.push(u);else if(f===V)n=s.pop(),s.push(n[u.value]);else if(f===z)s.pop();else if(f===_){for(w=u.value,l=[];w-- >0;)l.unshift(s.pop());s.push(l)}else throw new Error("invalid Expression")}if(s.length>1)throw new Error("invalid Expression (parity)");return s[0]===0?0:I(s[0],r)}function Fe(e,t,r){return pe(e)?e:{type:he,value:function(s){return q(e.value,t,s)}}}function pe(e){return e&&e.type===he}function I(e,t){return pe(e)?e.value(t):e}function le(e,t){for(var r=[],s,n,a,i,h,l,w=0;w<e.length;w++){var p=e[w],y=p.type;if(y===O)typeof p.value=="number"&&p.value<0?r.push("("+p.value+")"):Array.isArray(p.value)?r.push("["+p.value.map(xe).join(", ")+"]"):r.push(xe(p.value));else if(y===$)n=r.pop(),s=r.pop(),i=p.value,t?i==="^"?r.push("Math.pow("+s+", "+n+")"):i==="and"?r.push("(!!"+s+" && !!"+n+")"):i==="or"?r.push("(!!"+s+" || !!"+n+")"):i==="||"?r.push("(function(a,b){ return Array.isArray(a) && Array.isArray(b) ? a.concat(b) : String(a) + String(b); }(("+s+"),("+n+")))"):i==="=="?r.push("("+s+" === "+n+")"):i==="!="?r.push("("+s+" !== "+n+")"):i==="["?r.push(s+"[("+n+") | 0]"):r.push("("+s+" "+i+" "+n+")"):i==="["?r.push(s+"["+n+"]"):r.push("("+s+" "+i+" "+n+")");else if(y===X)if(a=r.pop(),n=r.pop(),s=r.pop(),i=p.value,i==="?")r.push("("+s+" ? "+n+" : "+a+")");else throw new Error("invalid Expression");else if(y===j||y===L)r.push(p.value);else if(y===G)s=r.pop(),i=p.value,i==="-"||i==="+"?r.push("("+i+s+")"):t?i==="not"?r.push("(!"+s+")"):i==="!"?r.push("fac("+s+")"):r.push(i+"("+s+")"):i==="!"?r.push("("+s+"!)"):r.push("("+i+" "+s+")");else if(y===B){for(l=p.value,h=[];l-- >0;)h.unshift(r.pop());i=r.pop(),r.push(i+"("+h.join(", ")+")")}else if(y===Q){for(n=r.pop(),l=p.value,h=[];l-- >0;)h.unshift(r.pop());s=r.pop(),t?r.push("("+s+" = function("+h.join(", ")+") { return "+n+" })"):r.push("("+s+"("+h.join(", ")+") = "+n+")")}else if(y===V)s=r.pop(),r.push(s+"."+p.value);else if(y===_){for(l=p.value,h=[];l-- >0;)h.unshift(r.pop());r.push("["+h.join(", ")+"]")}else if(y===M)r.push("("+le(p.value,t)+")");else if(y!==z)throw new Error("invalid Expression")}return r.length>1&&(t?r=[r.join(",")]:r=[r.join(";")]),String(r[0])}function xe(e){return typeof e=="string"?JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"):e}function U(e,t){for(var r=0;r<e.length;r++)if(e[r]===t)return!0;return!1}function ce(e,t,r){r=r||{};for(var s=!!r.withMembers,n=null,a=0;a<e.length;a++){var i=e[a];i.type===j||i.type===L?!s&&!U(t,i.value)?t.push(i.value):(n!==null&&(U(t,n)||t.push(n)),n=i.value):i.type===V&&s&&n!==null?n+="."+i.value:i.type===M?ce(i.value,t,r):n!==null&&(U(t,n)||t.push(n),n=null)}n!==null&&!U(t,n)&&t.push(n)}function T(e,t){this.tokens=e,this.parser=t,this.unaryOps=t.unaryOps,this.binaryOps=t.binaryOps,this.ternaryOps=t.ternaryOps,this.functions=t.functions}T.prototype.simplify=function(e){return e=e||{},new T(ue(this.tokens,this.unaryOps,this.binaryOps,this.ternaryOps,e),this.parser)};T.prototype.substitute=function(e,t){return t instanceof T||(t=this.parser.parse(String(t))),new T(Te(this.tokens,e,t),this.parser)};T.prototype.evaluate=function(e){return e=e||{},q(this.tokens,this,e)};T.prototype.toString=function(){return le(this.tokens,!1)};T.prototype.symbols=function(e){e=e||{};var t=[];return ce(this.tokens,t,e),t};T.prototype.variables=function(e){e=e||{};var t=[];ce(this.tokens,t,e);var r=this.functions;return t.filter(function(s){return!(s in r)})};T.prototype.toJSFunction=function(e,t){var r=this,s=new Function(e,"with(this.functions) with (this.ternaryOps) with (this.binaryOps) with (this.unaryOps) { return "+le(this.simplify(t).tokens,!0)+"; }");return function(){return s.apply(r,arguments)}};var W="TEOF",x="TOP",J="TNUMBER",Ce="TSTRING",m="TPAREN",H="TBRACKET",ee="TCOMMA",fe="TNAME",ve="TSEMICOLON";function Ie(e,t,r){this.type=e,this.value=t,this.index=r}Ie.prototype.toString=function(){return this.type+": "+this.value};function b(e,t){this.pos=0,this.current=null,this.unaryOps=e.unaryOps,this.binaryOps=e.binaryOps,this.ternaryOps=e.ternaryOps,this.consts=e.consts,this.expression=t,this.savedPosition=0,this.savedCurrent=null,this.options=e.options,this.parser=e}b.prototype.newToken=function(e,t,r){return new Ie(e,t,r??this.pos)};b.prototype.save=function(){this.savedPosition=this.pos,this.savedCurrent=this.current};b.prototype.restore=function(){this.pos=this.savedPosition,this.current=this.savedCurrent};b.prototype.next=function(){if(this.pos>=this.expression.length)return this.newToken(W,"EOF");if(this.isWhitespace()||this.isComment())return this.next();if(this.isRadixInteger()||this.isNumber()||this.isOperator()||this.isString()||this.isParen()||this.isBracket()||this.isComma()||this.isSemicolon()||this.isNamedOp()||this.isConst()||this.isName())return this.current;this.parseError('Unknown character "'+this.expression.charAt(this.pos)+'"')};b.prototype.isString=function(){var e=!1,t=this.pos,r=this.expression.charAt(t);if(r==="'"||r==='"')for(var s=this.expression.indexOf(r,t+1);s>=0&&this.pos<this.expression.length;){if(this.pos=s+1,this.expression.charAt(s-1)!=="\\"){var n=this.expression.substring(t+1,s);this.current=this.newToken(Ce,this.unescape(n),t),e=!0;break}s=this.expression.indexOf(r,s+1)}return e};b.prototype.isParen=function(){var e=this.expression.charAt(this.pos);return e==="("||e===")"?(this.current=this.newToken(m,e),this.pos++,!0):!1};b.prototype.isBracket=function(){var e=this.expression.charAt(this.pos);return(e==="["||e==="]")&&this.isOperatorEnabled("[")?(this.current=this.newToken(H,e),this.pos++,!0):!1};b.prototype.isComma=function(){var e=this.expression.charAt(this.pos);return e===","?(this.current=this.newToken(ee,","),this.pos++,!0):!1};b.prototype.isSemicolon=function(){var e=this.expression.charAt(this.pos);return e===";"?(this.current=this.newToken(ve,";"),this.pos++,!0):!1};b.prototype.isConst=function(){for(var e=this.pos,t=e;t<this.expression.length;t++){var r=this.expression.charAt(t);if(r.toUpperCase()===r.toLowerCase()&&(t===this.pos||r!=="_"&&r!=="."&&(r<"0"||r>"9")))break}if(t>e){var s=this.expression.substring(e,t);if(s in this.consts)return this.current=this.newToken(J,this.consts[s]),this.pos+=s.length,!0}return!1};b.prototype.isNamedOp=function(){for(var e=this.pos,t=e;t<this.expression.length;t++){var r=this.expression.charAt(t);if(r.toUpperCase()===r.toLowerCase()&&(t===this.pos||r!=="_"&&(r<"0"||r>"9")))break}if(t>e){var s=this.expression.substring(e,t);if(this.isOperatorEnabled(s)&&(s in this.binaryOps||s in this.unaryOps||s in this.ternaryOps))return this.current=this.newToken(x,s),this.pos+=s.length,!0}return!1};b.prototype.isName=function(){for(var e=this.pos,t=e,r=!1;t<this.expression.length;t++){var s=this.expression.charAt(t);if(s.toUpperCase()===s.toLowerCase()){if(t===this.pos&&(s==="$"||s==="_")){s==="_"&&(r=!0);continue}else if(t===this.pos||!r||s!=="_"&&(s<"0"||s>"9"))break}else r=!0}if(r){var n=this.expression.substring(e,t);return this.current=this.newToken(fe,n),this.pos+=n.length,!0}return!1};b.prototype.isWhitespace=function(){for(var e=!1,t=this.expression.charAt(this.pos);(t===" "||t==="	"||t===`
`||t==="\r")&&(e=!0,this.pos++,!(this.pos>=this.expression.length));)t=this.expression.charAt(this.pos);return e};var qe=/^[0-9a-f]{4}$/i;b.prototype.unescape=function(e){var t=e.indexOf("\\");if(t<0)return e;for(var r=e.substring(0,t);t>=0;){var s=e.charAt(++t);switch(s){case"'":r+="'";break;case'"':r+='"';break;case"\\":r+="\\";break;case"/":r+="/";break;case"b":r+="\b";break;case"f":r+="\f";break;case"n":r+=`
`;break;case"r":r+="\r";break;case"t":r+="	";break;case"u":var n=e.substring(t+1,t+5);qe.test(n)||this.parseError("Illegal escape sequence: \\u"+n),r+=String.fromCharCode(parseInt(n,16)),t+=4;break;default:throw this.parseError('Illegal escape sequence: "\\'+s+'"')}++t;var a=e.indexOf("\\",t);r+=e.substring(t,a<0?e.length:a),t=a}return r};b.prototype.isComment=function(){var e=this.expression.charAt(this.pos);return e==="/"&&this.expression.charAt(this.pos+1)==="*"?(this.pos=this.expression.indexOf("*/",this.pos)+2,this.pos===1&&(this.pos=this.expression.length),!0):!1};b.prototype.isRadixInteger=function(){var e=this.pos;if(e>=this.expression.length-2||this.expression.charAt(e)!=="0")return!1;++e;var t,r;if(this.expression.charAt(e)==="x")t=16,r=/^[0-9a-f]$/i,++e;else if(this.expression.charAt(e)==="b")t=2,r=/^[01]$/i,++e;else return!1;for(var s=!1,n=e;e<this.expression.length;){var a=this.expression.charAt(e);if(r.test(a))e++,s=!0;else break}return s&&(this.current=this.newToken(J,parseInt(this.expression.substring(n,e),t)),this.pos=e),s};b.prototype.isNumber=function(){for(var e=!1,t=this.pos,r=t,s=t,n=!1,a=!1,i;t<this.expression.length&&(i=this.expression.charAt(t),i>="0"&&i<="9"||!n&&i===".");)i==="."?n=!0:a=!0,t++,e=a;if(e&&(s=t),i==="e"||i==="E"){t++;for(var h=!0,l=!1;t<this.expression.length;){if(i=this.expression.charAt(t),h&&(i==="+"||i==="-"))h=!1;else if(i>="0"&&i<="9")l=!0,h=!1;else break;t++}l||(t=s)}return e?(this.current=this.newToken(J,parseFloat(this.expression.substring(r,t))),this.pos=t):this.pos=s,e};b.prototype.isOperator=function(){var e=this.pos,t=this.expression.charAt(this.pos);if(t==="+"||t==="-"||t==="*"||t==="/"||t==="%"||t==="^"||t==="?"||t===":"||t===".")this.current=this.newToken(x,t);else if(t==="∙"||t==="•")this.current=this.newToken(x,"*");else if(t===">")this.expression.charAt(this.pos+1)==="="?(this.current=this.newToken(x,">="),this.pos++):this.current=this.newToken(x,">");else if(t==="<")this.expression.charAt(this.pos+1)==="="?(this.current=this.newToken(x,"<="),this.pos++):this.current=this.newToken(x,"<");else if(t==="|")if(this.expression.charAt(this.pos+1)==="|")this.current=this.newToken(x,"||"),this.pos++;else return!1;else if(t==="=")this.expression.charAt(this.pos+1)==="="?(this.current=this.newToken(x,"=="),this.pos++):this.current=this.newToken(x,t);else if(t==="!")this.expression.charAt(this.pos+1)==="="?(this.current=this.newToken(x,"!="),this.pos++):this.current=this.newToken(x,t);else return!1;return this.pos++,this.isOperatorEnabled(this.current.value)?!0:(this.pos=e,!1)};b.prototype.isOperatorEnabled=function(e){return this.parser.isOperatorEnabled(e)};b.prototype.getCoordinates=function(){var e=0,t,r=-1;do e++,t=this.pos-r,r=this.expression.indexOf(`
`,r+1);while(r>=0&&r<this.pos);return{line:e,column:t}};b.prototype.parseError=function(e){var t=this.getCoordinates();throw new Error("parse error ["+t.line+":"+t.column+"]: "+e)};function g(e,t,r){this.parser=e,this.tokens=t,this.current=null,this.nextToken=null,this.next(),this.savedCurrent=null,this.savedNextToken=null,this.allowMemberAccess=r.allowMemberAccess!==!1}g.prototype.next=function(){return this.current=this.nextToken,this.nextToken=this.tokens.next()};g.prototype.tokenMatches=function(e,t){return typeof t>"u"?!0:Array.isArray(t)?U(t,e.value):typeof t=="function"?t(e):e.value===t};g.prototype.save=function(){this.savedCurrent=this.current,this.savedNextToken=this.nextToken,this.tokens.save()};g.prototype.restore=function(){this.tokens.restore(),this.current=this.savedCurrent,this.nextToken=this.savedNextToken};g.prototype.accept=function(e,t){return this.nextToken.type===e&&this.tokenMatches(this.nextToken,t)?(this.next(),!0):!1};g.prototype.expect=function(e,t){if(!this.accept(e,t)){var r=this.tokens.getCoordinates();throw new Error("parse error ["+r.line+":"+r.column+"]: Expected "+(t||e))}};g.prototype.parseAtom=function(e){var t=this.tokens.unaryOps;function r(n){return n.value in t}if(this.accept(fe)||this.accept(x,r))e.push(new v(j,this.current.value));else if(this.accept(J))e.push(new v(O,this.current.value));else if(this.accept(Ce))e.push(new v(O,this.current.value));else if(this.accept(m,"("))this.parseExpression(e),this.expect(m,")");else if(this.accept(H,"["))if(this.accept(H,"]"))e.push(new v(_,0));else{var s=this.parseArrayList(e);e.push(new v(_,s))}else throw new Error("unexpected "+this.nextToken)};g.prototype.parseExpression=function(e){var t=[];this.parseUntilEndStatement(e,t)||(this.parseVariableAssignmentExpression(t),!this.parseUntilEndStatement(e,t)&&this.pushExpression(e,t))};g.prototype.pushExpression=function(e,t){for(var r=0,s=t.length;r<s;r++)e.push(t[r])};g.prototype.parseUntilEndStatement=function(e,t){return this.accept(ve)?(this.nextToken&&this.nextToken.type!==W&&!(this.nextToken.type===m&&this.nextToken.value===")")&&t.push(new v(z)),this.nextToken.type!==W&&this.parseExpression(t),e.push(new v(M,t)),!0):!1};g.prototype.parseArrayList=function(e){for(var t=0;!this.accept(H,"]");)for(this.parseExpression(e),++t;this.accept(ee);)this.parseExpression(e),++t;return t};g.prototype.parseVariableAssignmentExpression=function(e){for(this.parseConditionalExpression(e);this.accept(x,"=");){var t=e.pop(),r=[],s=e.length-1;if(t.type===B){if(!this.tokens.isOperatorEnabled("()="))throw new Error("function definition is not permitted");for(var n=0,a=t.value+1;n<a;n++){var i=s-n;e[i].type===j&&(e[i]=new v(L,e[i].value))}this.parseVariableAssignmentExpression(r),e.push(new v(M,r)),e.push(new v(Q,t.value));continue}if(t.type!==j&&t.type!==V)throw new Error("expected variable for assignment");this.parseVariableAssignmentExpression(r),e.push(new v(L,t.value)),e.push(new v(M,r)),e.push(P("="))}};g.prototype.parseConditionalExpression=function(e){for(this.parseOrExpression(e);this.accept(x,"?");){var t=[],r=[];this.parseConditionalExpression(t),this.expect(x,":"),this.parseConditionalExpression(r),e.push(new v(M,t)),e.push(new v(M,r)),e.push(Oe("?"))}};g.prototype.parseOrExpression=function(e){for(this.parseAndExpression(e);this.accept(x,"or");){var t=[];this.parseAndExpression(t),e.push(new v(M,t)),e.push(P("or"))}};g.prototype.parseAndExpression=function(e){for(this.parseComparison(e);this.accept(x,"and");){var t=[];this.parseComparison(t),e.push(new v(M,t)),e.push(P("and"))}};var Le=["==","!=","<","<=",">=",">","in"];g.prototype.parseComparison=function(e){for(this.parseAddSub(e);this.accept(x,Le);){var t=this.current;this.parseAddSub(e),e.push(P(t.value))}};var Ve=["+","-","||"];g.prototype.parseAddSub=function(e){for(this.parseTerm(e);this.accept(x,Ve);){var t=this.current;this.parseTerm(e),e.push(P(t.value))}};var De=["*","/","%"];g.prototype.parseTerm=function(e){for(this.parseFactor(e);this.accept(x,De);){var t=this.current;this.parseFactor(e),e.push(P(t.value))}};g.prototype.parseFactor=function(e){var t=this.tokens.unaryOps;function r(n){return n.value in t}if(this.save(),this.accept(x,r)){if(this.current.value!=="-"&&this.current.value!=="+"){if(this.nextToken.type===m&&this.nextToken.value==="("){this.restore(),this.parseExponential(e);return}else if(this.nextToken.type===ve||this.nextToken.type===ee||this.nextToken.type===W||this.nextToken.type===m&&this.nextToken.value===")"){this.restore(),this.parseAtom(e);return}}var s=this.current;this.parseFactor(e),e.push(Z(s.value))}else this.parseExponential(e)};g.prototype.parseExponential=function(e){for(this.parsePostfixExpression(e);this.accept(x,"^");)this.parseFactor(e),e.push(P("^"))};g.prototype.parsePostfixExpression=function(e){for(this.parseFunctionCall(e);this.accept(x,"!");)e.push(Z("!"))};g.prototype.parseFunctionCall=function(e){var t=this.tokens.unaryOps;function r(a){return a.value in t}if(this.accept(x,r)){var s=this.current;this.parseAtom(e),e.push(Z(s.value))}else for(this.parseMemberExpression(e);this.accept(m,"(");)if(this.accept(m,")"))e.push(new v(B,0));else{var n=this.parseArgumentList(e);e.push(new v(B,n))}};g.prototype.parseArgumentList=function(e){for(var t=0;!this.accept(m,")");)for(this.parseExpression(e),++t;this.accept(ee);)this.parseExpression(e),++t;return t};g.prototype.parseMemberExpression=function(e){for(this.parseAtom(e);this.accept(x,".")||this.accept(H,"[");){var t=this.current;if(t.value==="."){if(!this.allowMemberAccess)throw new Error('unexpected ".", member access is not permitted');this.expect(fe),e.push(new v(V,this.current.value))}else if(t.value==="["){if(!this.tokens.isOperatorEnabled("["))throw new Error('unexpected "[]", arrays are disabled');this.parseExpression(e),this.expect(H,"]"),e.push(P("["))}else throw new Error("unexpected symbol: "+t.value)}};function Ue(e,t){return Number(e)+Number(t)}function Be(e,t){return e-t}function _e(e,t){return e*t}function He(e,t){return e/t}function Ge(e,t){return e%t}function $e(e,t){return Array.isArray(e)&&Array.isArray(t)?e.concat(t):""+e+t}function Xe(e,t){return e===t}function Ke(e,t){return e!==t}function Ye(e,t){return e>t}function We(e,t){return e<t}function Qe(e,t){return e>=t}function ze(e,t){return e<=t}function Ze(e,t){return!!(e&&t)}function Je(e,t){return!!(e||t)}function et(e,t){return U(t,e)}function tt(e){return(Math.exp(e)-Math.exp(-e))/2}function rt(e){return(Math.exp(e)+Math.exp(-e))/2}function st(e){return e===1/0?1:e===-1/0?-1:(Math.exp(e)-Math.exp(-e))/(Math.exp(e)+Math.exp(-e))}function nt(e){return e===-1/0?e:Math.log(e+Math.sqrt(e*e+1))}function it(e){return Math.log(e+Math.sqrt(e*e-1))}function at(e){return Math.log((1+e)/(1-e))/2}function ge(e){return Math.log(e)*Math.LOG10E}function ot(e){return-e}function ut(e){return!e}function ht(e){return e<0?Math.ceil(e):Math.floor(e)}function pt(e){return Math.random()*(e||1)}function be(e){return de(e+1)}function lt(e){return isFinite(e)&&e===Math.round(e)}var ct=4.7421875,oe=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];function de(e){var t,r;if(lt(e)){if(e<=0)return isFinite(e)?1/0:NaN;if(e>171)return 1/0;for(var s=e-2,n=e-1;s>1;)n*=s,s--;return n===0&&(n=1),n}if(e<.5)return Math.PI/(Math.sin(Math.PI*e)*de(1-e));if(e>=171.35)return 1/0;if(e>85){var a=e*e,i=a*e,h=i*e,l=h*e;return Math.sqrt(2*Math.PI/e)*Math.pow(e/Math.E,e)*(1+1/(12*e)+1/(288*a)-139/(51840*i)-571/(2488320*h)+163879/(209018880*l)+5246819/(75246796800*l*e))}--e,r=oe[0];for(var w=1;w<oe.length;++w)r+=oe[w]/(e+w);return t=e+ct+.5,Math.sqrt(2*Math.PI)*Math.pow(t,e+.5)*Math.exp(-t)*r}function ft(e){return Array.isArray(e)?e.length:String(e).length}function Ee(){for(var e=0,t=0,r=0;r<arguments.length;r++){var s=Math.abs(arguments[r]),n;t<s?(n=t/s,e=e*n*n+1,t=s):s>0?(n=s/t,e+=n*n):e+=s}return t===1/0?1/0:t*Math.sqrt(e)}function ke(e,t,r){return e?t:r}function vt(e,t){return typeof t>"u"||+t==0?Math.round(e):(e=+e,t=-+t,isNaN(e)||!(typeof t=="number"&&t%1===0)?NaN:(e=e.toString().split("e"),e=Math.round(+(e[0]+"e"+(e[1]?+e[1]-t:-t))),e=e.toString().split("e"),+(e[0]+"e"+(e[1]?+e[1]+t:t))))}function dt(e,t,r){return r&&(r[e]=t),t}function yt(e,t){return e[t|0]}function wt(e){return arguments.length===1&&Array.isArray(e)?Math.max.apply(Math,e):Math.max.apply(Math,arguments)}function xt(e){return arguments.length===1&&Array.isArray(e)?Math.min.apply(Math,e):Math.min.apply(Math,arguments)}function gt(e,t){if(typeof e!="function")throw new Error("First argument to map is not a function");if(!Array.isArray(t))throw new Error("Second argument to map is not an array");return t.map(function(r,s){return e(r,s)})}function bt(e,t,r){if(typeof e!="function")throw new Error("First argument to fold is not a function");if(!Array.isArray(r))throw new Error("Second argument to fold is not an array");return r.reduce(function(s,n,a){return e(s,n,a)},t)}function Et(e,t){if(typeof e!="function")throw new Error("First argument to filter is not a function");if(!Array.isArray(t))throw new Error("Second argument to filter is not an array");return t.filter(function(r,s){return e(r,s)})}function kt(e,t){if(!(Array.isArray(t)||typeof t=="string"))throw new Error("Second argument to indexOf is not a string or array");return t.indexOf(e)}function Mt(e,t){if(!Array.isArray(t))throw new Error("Second argument to join is not an array");return t.join(e)}function At(e){return(e>0)-(e<0)||+e}var Me=1/3;function Ot(e){return e<0?-Math.pow(-e,Me):Math.pow(e,Me)}function Tt(e){return Math.exp(e)-1}function Ct(e){return Math.log(1+e)}function It(e){return Math.log(e)/Math.LN2}function N(e){this.options=e||{},this.unaryOps={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sinh:Math.sinh||tt,cosh:Math.cosh||rt,tanh:Math.tanh||st,asinh:Math.asinh||nt,acosh:Math.acosh||it,atanh:Math.atanh||at,sqrt:Math.sqrt,cbrt:Math.cbrt||Ot,log:Math.log,log2:Math.log2||It,ln:Math.log,lg:Math.log10||ge,log10:Math.log10||ge,expm1:Math.expm1||Tt,log1p:Math.log1p||Ct,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,trunc:Math.trunc||ht,"-":ot,"+":Number,exp:Math.exp,not:ut,length:ft,"!":be,sign:Math.sign||At},this.binaryOps={"+":Ue,"-":Be,"*":_e,"/":He,"%":Ge,"^":Math.pow,"||":$e,"==":Xe,"!=":Ke,">":Ye,"<":We,">=":Qe,"<=":ze,and:Ze,or:Je,in:et,"=":dt,"[":yt},this.ternaryOps={"?":ke},this.functions={random:pt,fac:be,min:xt,max:wt,hypot:Math.hypot||Ee,pyt:Math.hypot||Ee,pow:Math.pow,atan2:Math.atan2,if:ke,gamma:de,roundTo:vt,map:gt,fold:bt,filter:Et,indexOf:kt,join:Mt},this.consts={E:Math.E,PI:Math.PI,true:!0,false:!1}}N.prototype.parse=function(e){var t=[],r=new g(this,new b(this,e),{allowMemberAccess:this.options.allowMemberAccess});return r.parseExpression(t),r.expect(W,"EOF"),new T(t,this)};N.prototype.evaluate=function(e,t){return this.parse(e).evaluate(t)};var je=new N;N.parse=function(e){return je.parse(e)};N.evaluate=function(e,t){return je.parse(e).evaluate(t)};var Ae={"+":"add","-":"subtract","*":"multiply","/":"divide","%":"remainder","^":"power","!":"factorial","<":"comparison",">":"comparison","<=":"comparison",">=":"comparison","==":"comparison","!=":"comparison","||":"concatenate",and:"logical",or:"logical",not:"logical","?":"conditional",":":"conditional","=":"assignment","[":"array","()=":"fndef"};function jt(e){return Ae.hasOwnProperty(e)?Ae[e]:e}N.prototype.isOperatorEnabled=function(e){var t=jt(e),r=this.options.operators||{};return!(t in r)||!!r[t]};function Pt(){let[e,t]=C.useState(!1),[r,s]=C.useState(!1),[n,a]=C.useState(!1),[i,h]=C.useState(!0),[l,w]=C.useState(!1),[p,y]=C.useState(""),[u,f]=C.useState(""),R=C.useRef(),te=["1","2","3","4","5","6","7","8","9","0","."],{dark:F,mainDarkBackground:re}=C.useContext(Re);const d=o=>{if(e){if(o==="+"||o==="-"||o==="*"||o==="/"){let k=[...p].pop();k==="+"||k==="*"||k==="/"||p===""||y(A=>A+o)}else ie(),y(E=>E+o);t(!1)}else if(o==="+"||o==="*"||o==="/"){let k=[...p].pop();k==="+"||k==="-"||k==="*"||k==="/"||p===""||y(A=>A+o)}else y(E=>E+o)},D=()=>{if(p!==""&&p!=="History")try{let E=new N().evaluate(p);f(E),t(!0),a(!0),s(!0)}catch{f("Error")}},K=new N,S=()=>{if(p==="")return-1;let o;try{if(o=K.evaluate(p),o>=0){let E=p;for(let Ne of E)if(Ne===".")throw new Error("Not an integer");let k=[],A=Math.floor(o);for(;A>0;)k.push(A%2),A=Math.floor(A/2);k=k.reverse().join(""),k=k+" bin",f(o===0?"0 bin":k),a(!0),s(!1),w(!0)}else f("Error")}catch{f("Error")}t(!0)},Y=()=>{let o=p,E=0,k=o.length-1;if(t(!0),p!=="History"&&p!=="")try{for(const A of o){if(A<0||A>1)throw error;E=E+A*2**k,k=k-1}if(!isNaN(E))f(E+" dec");else throw error;t(!0),a(!0),s(!1),w(!0)}catch{f("Error")}},se=()=>{if(n){if(u!=="Error")if(!l)window.navigator.clipboard.writeText(u);else{let o=[...u];o.pop(),o.pop(),o.pop(),o.pop(),window.navigator.clipboard.writeText(o.join(""))}}else if(e){let o=[...u],E=o.indexOf("=");o=o.slice(E+2),window.navigator.clipboard.writeText(o.join(""))}else{let o=[...u],E=o.indexOf("=");o=o.slice(E+2),o.pop(),o.pop(),o.pop(),o.pop(),window.navigator.clipboard.writeText(o.join(""))}},ne=async()=>{let o=await window.navigator.clipboard.readText();y(o),t(!0)},ye=()=>{let o=[...p];o.pop(),o=o.join(""),y(o)},ie=()=>{y(""),f("")},me=o=>{switch(o.key){case"0":d("0");break;case"1":d("1");break;case"2":d("2");break;case"3":d("3");break;case"4":d("4");break;case"5":d("5");break;case"6":d("6");break;case"7":d("7");break;case"8":d("8");break;case"9":d("9");break;case"*":d("*");break;case"-":d("-");break;case"+":d("+");break;case"/":d("/");break;case"Enter":D();break;case"D":Y();break;case"d":Y();break;case"C":se();break;case"c":se();break;case"B":S();break;case"b":S();break;case"Backspace":ye();break;case"Esc":ie();break;case"H":ae();break;case"h":ae();break;case"V":ne();break;case"v":ne();break}},we=o=>o===0?1:o*we(o-1),Pe=()=>{if(p!==""){let o;try{o=Number(K.evaluate(p)),o=we(o),y(p+"!"),f(o+" fac"),a(!0),w(!0)}catch{f("Error")}}},ae=()=>{if(p!=="History"){let o=localStorage.getItem("History");[...o].length<5?console.log("history not"):(f(o),y("History"),t(!0),a(!1))}},Se=()=>{h(!i)};return C.useEffect(()=>{u!==""&&n&&u!=="Error"&&localStorage.setItem("History",`${p} = ${u}`)},[u]),c.jsx(c.Fragment,{children:c.jsxs("div",{style:{background:F&&re},id:"calculator",onKeyDown:()=>me(event),onClick:()=>R.current.focus(),children:[c.jsxs("div",{id:"top-calculator",children:[c.jsx("h1",{children:"Calculator"}),c.jsx("a",{style:{textDecoration:"underline",color:"#aaa"},href:"#/quadratics",children:"Quadratics"}),c.jsx("hr",{style:{width:"100%"}}),c.jsx("button",{id:"button2",onClick:Se,children:"Extra"}),c.jsx("input",{style:{color:F&&"#ccc"},value:p,id:"display1",onClick:ne,readOnly:!0,ref:R,title:"Click to paste"}),c.jsx("input",{style:{color:F&&"#eee"},value:u,id:"display2",onClick:se,readOnly:!0,title:" Click to Copy answer"})]}),c.jsxs("div",{id:"container-buttons",children:[c.jsxs("div",{id:"digits-container",children:[te.map(o=>c.jsx("button",{onClick:()=>d(o),children:o},o)),c.jsx("button",{onClick:ye,id:"des1",children:"D"}),c.jsx("button",{onClick:D,id:"equal",children:"="}),c.jsx("button",{onClick:ie,id:"des2",children:"C"})]}),c.jsxs("div",{id:"operators-container",children:[i?c.jsx("button",{onClick:()=>d("+"),children:"+"}):c.jsx("button",{onClick:()=>d("**"),children:"^"}),i?c.jsx("button",{onClick:()=>d("-"),children:"-"}):c.jsx("button",{onClick:()=>d(""),children:"?"}),i?c.jsx("button",{onClick:()=>d("/"),children:"÷"}):c.jsx("button",{onClick:()=>d(""),children:"?"}),i?c.jsx("button",{onClick:()=>d("*"),children:"×"}):c.jsx("button",{onClick:()=>d(""),children:"?"}),i?c.jsx("button",{onClick:Pe,children:"!"}):c.jsx("button",{onClick:()=>d(""),children:"?"}),i?c.jsx("button",{onClick:ae,children:"H"}):c.jsx("button",{onClick:()=>d(""),children:"?"}),i?c.jsx("button",{onClick:()=>d("+"),children:"+"}):c.jsx("button",{onClick:()=>d("**"),children:"^"}),i?c.jsx("button",{onClick:()=>d("+"),children:"+"}):c.jsx("button",{onClick:()=>d("**"),children:"^"}),c.jsx("button",{onClick:S,id:"bin",children:"bin"}),c.jsx("button",{onClick:Y,id:"dec",children:"dec"})]}),c.jsx("div",{id:"equals-container"})]})]})})}export{Pt as default};
